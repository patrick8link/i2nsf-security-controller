<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>_confd.ha API documentation</title>
<meta name="description" content="Low level module for connecting to ConfD HA subsystem â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<style>
#pubhub-container .pubhub-doc-container article#content,
#pubhub-container .pubhub-doc-container nav#sidebar {
width: inherit;
height: inherit;
}
</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>_confd.ha</code></h1>
</header>
<section id="section-intro">
<p>Low level module for connecting to ConfD HA subsystem.</p>
<p>This module is used to connect to the ConfD High Availability (HA)
subsystem. ConfD can replicate the configuration data on several nodes
in a cluster. The purpose of this API is to manage the HA
functionality. The details on usage of the HA API are described in the
chapter High availability in the User Guide.</p>
<p>This documentation should be read together with the confd_lib_ha(3) man page.</p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="_confd.ha.bemaster"><code class="name flex">
<span>def <span class="ident">bemaster</span></span>(<span>sock, mynodeid)</span>
</code></dt>
<dd>
<div class="desc"><p>This function is deprecated and will be removed.
Use beprimary() instead.</p></div>
</dd>
<dt id="_confd.ha.benone"><code class="name flex">
<span>def <span class="ident">benone</span></span>(<span>sock)</span>
</code></dt>
<dd>
<div class="desc"><p>Instruct a node to resume the initial state, i.e. neither become primary
nor secondary.</p>
<p>Keyword arguments:</p>
<ul>
<li>sock &ndash; a previously connected HA socket</li>
</ul></div>
</dd>
<dt id="_confd.ha.beprimary"><code class="name flex">
<span>def <span class="ident">beprimary</span></span>(<span>sock, mynodeid)</span>
</code></dt>
<dd>
<div class="desc"><p>Instruct a HA node to be primary and also give the node a name.</p>
<p>Keyword arguments:</p>
<ul>
<li>sock &ndash; a previously connected HA socket</li>
<li>mynodeid &ndash; name of the node (Value or string)</li>
</ul></div>
</dd>
<dt id="_confd.ha.berelay"><code class="name flex">
<span>def <span class="ident">berelay</span></span>(<span>sock)</span>
</code></dt>
<dd>
<div class="desc"><p>Instruct an established HA secondary node to be a relay for other
secondary nodes.</p>
<p>Keyword arguments:</p>
<ul>
<li>sock &ndash; a previously connected HA socket</li>
</ul></div>
</dd>
<dt id="_confd.ha.besecondary"><code class="name flex">
<span>def <span class="ident">besecondary</span></span>(<span>sock, mynodeid, primary_id, primary_ip, waitreply)</span>
</code></dt>
<dd>
<div class="desc"><p>Instruct a NCS HA node to be a secondary node with a named primary node.
If waitreply is True the function is synchronous and it will hang until the
node has initialized its CDB database. This may mean that the CDB database
is copied in its entirety from the primary node. If False, we do not wait
for the reply, but it is possible to use a notifications socket and get
notified asynchronously via a HA_INFO_BESECONDARY_RESULT notification.
In both cases, it is also possible to use a notifications socket and get
notified asynchronously when CDB at the secondary node is initialized.</p>
<p>Keyword arguments:</p>
<ul>
<li>sock
&ndash; a previously connected HA socket</li>
<li>mynodeid
&ndash; name of this secondary node (Value or string)</li>
<li>primary_id &ndash; name of the primary node (Value or string)</li>
<li>primary_ip &ndash; ip address of the primary node</li>
<li>waitreply
&ndash; synchronous or not (bool)</li>
</ul></div>
</dd>
<dt id="_confd.ha.beslave"><code class="name flex">
<span>def <span class="ident">beslave</span></span>(<span>sock, mynodeid, primary_id, primary_ip, waitreply)</span>
</code></dt>
<dd>
<div class="desc"><p>This function is deprecated and will be removed.
Use besecondary() instead.</p></div>
</dd>
<dt id="_confd.ha.connect"><code class="name flex">
<span>def <span class="ident">connect</span></span>(<span>sock, token, ip, port, pstr)</span>
</code></dt>
<dd>
<div class="desc"><p>Connect a HA socket which can be used to control a NCS HA node. The token
is a secret string that must be shared by all participants in the cluster.
There can only be one HA socket towards NCS. A new call to
ha_connect() makes NCS close the previous connection and reset the token to
the new value.</p>
<p>Keyword arguments:</p>
<ul>
<li>sock &ndash; a Python socket instance</li>
<li>token &ndash; secret string</li>
<li>ip &ndash; the ip address if socket is AF_INET or AF_INET6 (optional)</li>
<li>port &ndash; the port if socket is AF_INET or AF_INET6 (optional)</li>
<li>pstr &ndash; a filename if socket is AF_UNIX (optional).</li>
</ul></div>
</dd>
<dt id="_confd.ha.secondary_dead"><code class="name flex">
<span>def <span class="ident">secondary_dead</span></span>(<span>sock, nodeid)</span>
</code></dt>
<dd>
<div class="desc"><p>This function must be used by the application to inform NCS HA subsystem
that another node which is possibly connected to NCS is dead.</p>
<p>Keyword arguments:</p>
<ul>
<li>sock &ndash; a previously connected HA socket</li>
<li>nodeid &ndash; name of the node (Value or string)</li>
</ul></div>
</dd>
<dt id="_confd.ha.slave_dead"><code class="name flex">
<span>def <span class="ident">slave_dead</span></span>(<span>sock, nodeid)</span>
</code></dt>
<dd>
<div class="desc"><p>This function is deprecated and will be removed.
Use secondary_dead() instead.</p></div>
</dd>
<dt id="_confd.ha.status"><code class="name flex">
<span>def <span class="ident">status</span></span>(<span>sock)</span>
</code></dt>
<dd>
<div class="desc"><p>Query a ConfD HA node for its status.</p>
<p>Returns a 2-tuple of the HA status of the node in the format
(State,[list_of_nodes]) where 'list_of_nodes' is the primary/secondary(s)
connected with node.</p>
<p>Keyword arguments:</p>
<ul>
<li>sock &ndash; a previously connected HA socket</li>
</ul></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="_confd" href="index.html">_confd</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="_confd.ha.bemaster" href="#_confd.ha.bemaster">bemaster</a></code></li>
<li><code><a title="_confd.ha.benone" href="#_confd.ha.benone">benone</a></code></li>
<li><code><a title="_confd.ha.beprimary" href="#_confd.ha.beprimary">beprimary</a></code></li>
<li><code><a title="_confd.ha.berelay" href="#_confd.ha.berelay">berelay</a></code></li>
<li><code><a title="_confd.ha.besecondary" href="#_confd.ha.besecondary">besecondary</a></code></li>
<li><code><a title="_confd.ha.beslave" href="#_confd.ha.beslave">beslave</a></code></li>
<li><code><a title="_confd.ha.connect" href="#_confd.ha.connect">connect</a></code></li>
<li><code><a title="_confd.ha.secondary_dead" href="#_confd.ha.secondary_dead">secondary_dead</a></code></li>
<li><code><a title="_confd.ha.slave_dead" href="#_confd.ha.slave_dead">slave_dead</a></code></li>
<li><code><a title="_confd.ha.status" href="#_confd.ha.status">status</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>